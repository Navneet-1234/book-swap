{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Requests(){const[sentRequests,setSentRequests]=useState([]);const[receivedRequests,setReceivedRequests]=useState([]);const navigate=useNavigate();const fetchRequests=async()=>{try{const res=await axios.get('http://localhost:5000/api/requests/my-requests',{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});setSentRequests(res.data.sentRequests);setReceivedRequests(res.data.receivedRequests);}catch(error){console.error('Error fetching requests:',error);alert('Failed to fetch requests. Please try again.');navigate('/login');}};useEffect(()=>{fetchRequests();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);const handleRequestAction=async(requestId,status)=>{try{await axios.put(\"http://localhost:5000/api/requests/\".concat(requestId),{status},{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('token'))}});fetchRequests();}catch(error){console.error('Error updating request:',error);alert('Failed to update request. Please try again.');navigate('/login');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"requests-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"My Requests\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Sent Requests\"}),sentRequests.map(request=>/*#__PURE__*/_jsxs(\"div\",{className:\"book-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:request.book.title}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Author: \",request.book.author]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Owner: \",request.owner.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Status: \",request.status]})]},request._id)),/*#__PURE__*/_jsx(\"h2\",{children:\"Received Requests\"}),receivedRequests.map(request=>/*#__PURE__*/_jsxs(\"div\",{className:\"book-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:request.book.title}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Author: \",request.book.author]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Requester: \",request.requester.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Status: \",request.status]}),request.status==='pending'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"button\",onClick:()=>handleRequestAction(request._id,'accepted'),children:\"Accept\"}),/*#__PURE__*/_jsx(\"button\",{className:\"button\",onClick:()=>handleRequestAction(request._id,'declined'),children:\"Decline\"})]})]},request._id))]});}export default Requests;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","Requests","sentRequests","setSentRequests","receivedRequests","setReceivedRequests","navigate","fetchRequests","res","get","headers","Authorization","concat","localStorage","getItem","data","error","console","alert","handleRequestAction","requestId","status","put","className","children","map","request","book","title","author","owner","username","_id","requester","onClick"],"sources":["D:/book-swap/client/src/pages/Requests.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nfunction Requests() {\r\n  const [sentRequests, setSentRequests] = useState([]);\r\n  const [receivedRequests, setReceivedRequests] = useState([]);\r\n  const navigate = useNavigate();\r\n\r\n  const fetchRequests = async () => {\r\n    try {\r\n      const res = await axios.get('http://localhost:5000/api/requests/my-requests', {\r\n        headers: { Authorization: `Bearer ${localStorage.getItem('token')}` }\r\n      });\r\n      setSentRequests(res.data.sentRequests);\r\n      setReceivedRequests(res.data.receivedRequests);\r\n    } catch (error) {\r\n      console.error('Error fetching requests:', error);\r\n      alert('Failed to fetch requests. Please try again.');\r\n      navigate('/login');\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchRequests();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const handleRequestAction = async (requestId, status) => {\r\n    try {\r\n      await axios.put(`http://localhost:5000/api/requests/${requestId}`, \r\n        { status },\r\n        { headers: { Authorization: `Bearer ${localStorage.getItem('token')}` } }\r\n      );\r\n      fetchRequests();\r\n    } catch (error) {\r\n      console.error('Error updating request:', error);\r\n      alert('Failed to update request. Please try again.');\r\n      navigate('/login');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"requests-container\">\r\n      <h1>My Requests</h1>\r\n      \r\n      <h2>Sent Requests</h2>\r\n      {sentRequests.map(request => (\r\n        <div key={request._id} className=\"book-card\">\r\n          <h3>{request.book.title}</h3>\r\n          <p>Author: {request.book.author}</p>\r\n          <p>Owner: {request.owner.username}</p>\r\n          <p>Status: {request.status}</p>\r\n        </div>\r\n      ))}\r\n\r\n      <h2>Received Requests</h2>\r\n      {receivedRequests.map(request => (\r\n        <div key={request._id} className=\"book-card\">\r\n          <h3>{request.book.title}</h3>\r\n          <p>Author: {request.book.author}</p>\r\n          <p>Requester: {request.requester.username}</p>\r\n          <p>Status: {request.status}</p>\r\n          {request.status === 'pending' && (\r\n            <div>\r\n              <button \r\n                className=\"button\" \r\n                onClick={() => handleRequestAction(request._id, 'accepted')}\r\n              >\r\n                Accept\r\n              </button>\r\n              <button \r\n                className=\"button\" \r\n                onClick={() => handleRequestAction(request._id, 'declined')}\r\n              >\r\n                Decline\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Requests;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}